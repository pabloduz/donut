<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Framework de Segurança IA - Painel de Análise Comparativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 226, 0.3) 0%, transparent 50%),
                linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
            min-height: 100vh;
            color: #1e293b;
            position: relative;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
            font-weight: 400;
            letter-spacing: -0.01em;
            line-height: 1.6;
            overflow-x: hidden;
            overflow-y: auto;
            transition: background 0.3s ease, color 0.3s ease;
        }

        /* Melhorias tipográficas */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            letter-spacing: -0.025em;
            line-height: 1.2;
            margin-bottom: 0.5em;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
        }

        h2 {
            font-size: 2rem;
            font-weight: 600;
        }

        p {
            line-height: 1.7;
            margin-bottom: 1em;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .text-xs {
            font-size: 0.75rem;
            line-height: 1.4;
        }

        /* Modo Escuro */
        body.dark {
            background: 
                radial-gradient(circle at 20% 80%, rgba(30, 41, 59, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(75, 85, 99, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(55, 65, 81, 0.4) 0%, transparent 50%),
                linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: #e2e8f0;
        }

        /* Ocultar scrollbar para Webkit browsers (Chrome, Safari, etc.) */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            letter-spacing: -0.025em;
            line-height: 1.2;
            margin-bottom: 0.5em;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
        }

        h2 {
            font-size: 2rem;
            font-weight: 600;
        }

        p {
            line-height: 1.7;
            margin-bottom: 1em;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .text-xs {
            font-size: 0.75rem;
            line-height: 1.4;
        }

        /* Modo Escuro */
        body.dark {
            background: 
                radial-gradient(circle at 20% 80%, rgba(30, 41, 59, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(75, 85, 99, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(55, 65, 81, 0.4) 0%, transparent 50%),
                linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: #e2e8f0;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 50%, rgba(255, 255, 255, 0.1) 100%),
                radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: -1;
        }
        
        .main-container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            position: relative;
            padding: 0 1rem;
        }
        
        /* Limitar largura apenas em telas muito grandes para manter legibilidade */
        @media (min-width: 1400px) {
            .main-container {
                max-width: 1200px;
                padding: 0 2rem;
            }
        }

        .donut-wrapper {
            width: 500px;
            height: 500px;
            position: relative;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            overflow: visible;
            padding: 15px;
        }

        @media (min-width: 768px) {
            .donut-wrapper {
                width: 600px;
                height: 600px;
                padding: 20px;
            }
        }

        @media (min-width: 1024px) {
            .donut-wrapper {
                width: 700px;
                height: 700px;
                padding: 25px;
            }
        }
        
        /* Aproveitar telas ultrawide e muito grandes */
        @media (min-width: 1400px) {
            .donut-wrapper {
                width: 800px;
                height: 800px;
                padding: 30px;
            }
        }
        
        @media (min-width: 1920px) {
            .donut-wrapper {
                width: 900px;
                height: 900px;
                padding: 35px;
            }
        }

        @media (min-width: 1280px) {
            .donut-wrapper {
                width: 800px;
                height: 800px;
                padding: 30px;
            }
        }
        
        .donut-piece {
            position: absolute;
            width: calc(50% - 2.5px);
            height: calc(50% - 2.5px);
            cursor: pointer;
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
        }

        .donut-piece img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.6s ease;
            position: relative;
        }

        /* Posicionamento das peças com espaçamento otimizado */
        .donut-piece.top-left {
            top: 0;
            left: 0;
            transform-origin: bottom right;
        }

        .donut-piece.top-right {
            top: 0;
            right: 0;
            transform-origin: bottom left;
        }

        .donut-piece.bottom-left {
            bottom: 0;
            left: 0;
            transform-origin: top right;
        }

        .donut-piece.bottom-right {
            bottom: 0;
            right: 0;
            transform-origin: top left;
        }

        /* Efeitos específicos para cada peça expandir para fora */
        .donut-piece.top-left:hover {
            z-index: 20;
            filter: drop-shadow(0 25px 70px rgba(0,0,0,0.5)) brightness(1.05);
            transform: scale(1.25) translate(-25px, -25px);
            overflow: visible;
        }

        .donut-piece.top-right:hover {
            z-index: 20;
            filter: drop-shadow(0 25px 70px rgba(0,0,0,0.5)) brightness(1.05);
            transform: scale(1.25) translate(25px, -25px);
            overflow: visible;
        }

        .donut-piece.bottom-left:hover {
            z-index: 20;
            filter: drop-shadow(0 25px 70px rgba(0,0,0,0.5)) brightness(1.05);
            transform: scale(1.25) translate(-25px, 25px);
            overflow: visible;
        }

        .donut-piece.bottom-right:hover {
            z-index: 20;
            filter: drop-shadow(0 25px 70px rgba(0,0,0,0.5)) brightness(1.05);
            transform: scale(1.25) translate(25px, 25px);
            overflow: visible;
        }

        .donut-piece:hover img {
            transform: scale(1.05);
            object-fit: cover;
            position: relative;
            z-index: 21;
            transform-origin: center center;
            filter: brightness(1.1) contrast(1.1);
        }

        .donut-piece:active {
            transform: scale(0.98);
            transition: all 0.1s ease;
        }

        /* Centro do donut - apenas ícone e texto */
        .donut-center {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: all 0.4s ease;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }        

        .donut-center:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        .donut-center i {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .donut-center h3 {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            color: #1e293b;
            text-align: center;
            margin: 0;
            line-height: 1.1;
            font-size: 14px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.1);
            letter-spacing: 0.5px;
        }

        @media (min-width: 768px) {
            .donut-center i {
                font-size: 3rem;
            }
            .donut-center h3 {
                font-size: 16px;
            }
        }

        @media (min-width: 1024px) {
            .donut-center i {
                font-size: 3.5rem;
            }
            .donut-center h3 {
                font-size: 18px;
            }
        }

        /* Centro do donut no modo escuro */
        body.dark .donut-center h3 {
            color: #f1f5f9;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }

        /* Labels externos posicionados - mais visíveis e distantes */
        .external-label {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 14px 28px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 
                0 15px 40px rgba(0,0,0,0.2),
                0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid rgba(100, 116, 139, 0.35); /* slate-500 @ 35% */
            z-index: 25;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            white-space: nowrap;
            min-width: 140px;
            text-align: center;
            color: #1e293b;
        }

        /* Modo escuro para labels */
        body.dark .external-label {
            background: rgba(30, 41, 59, 0.95);
            color: #e2e8f0;
            border: 2px solid rgba(71, 85, 105, 0.4);
        }

        body.dark .external-label:hover {
            background: rgba(51, 65, 85, 0.98);
            border-color: rgba(99, 102, 241, 0.6);
        }

        /* Gradiente do título aplicado ao texto (igual ao H1) */
        .gradient-title-text {
            background-image: linear-gradient(to right, #881337, #701a75, #581c87); /* rose-900 -> fuchsia-900 -> purple-900 */
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
        }

        /* Gradiente para o ícone de escudo */
        .gradient-shield-icon {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6, #ec4899); /* blue-500 -> purple-500 -> pink-500 */
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
        }

        .external-label:hover {
            transform: scale(1.12) translateZ(0);
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.3),
                0 8px 20px rgba(0,0,0,0.2);
            backdrop-filter: blur(30px);
            border-color: rgba(71, 85, 105, 0.5); /* slate-600 @ 50% */
            background: rgba(255, 255, 255, 0.98);
        }

        .external-label:active {
            transform: scale(1.03);
            transition: all 0.1s ease;
        }

        /* Posicionamento alinhado com centro das imagens do donut */
        .label-discovery {
            top: 8%;
            left: 8%;
            transform: translate(-50%, -50%);
        }

        .label-assessment {
            top: 8%;
            right: 8%;
            transform: translate(50%, -50%);
        }

        .label-control {
            bottom: 8%;
            left: 8%;
            transform: translate(-50%, 50%);
        }

        .label-governance {
            bottom: 8%;
            right: 8%;
            transform: translate(50%, 50%);
        }

        /* Cores específicas para cada label - mais vibrantes */
    .discovery-label { border-color: rgba(100, 116, 139, 0.35); }

        .discovery-label:hover {
            border-color: rgba(79, 70, 229, 0.5); /* indigo-600 @ 50% */
        }

    .assessment-label { border-color: rgba(100, 116, 139, 0.35); }

        .assessment-label:hover {
            border-color: rgba(79, 70, 229, 0.5);
        }

    .control-label { border-color: rgba(100, 116, 139, 0.35); }

        .control-label:hover {
            border-color: rgba(79, 70, 229, 0.5);
        }

    .governance-label { border-color: rgba(100, 116, 139, 0.35); }

        .governance-label:hover {
            border-color: rgba(79, 70, 229, 0.5);
        }

        /* Estilos para responsividade */
        @media (max-width: 768px) {
            .donut-wrapper {
                width: 320px;
                height: 320px;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 12px;
                overflow: visible;
            }
            
            .donut-center {
                top: 42%;
            }
            
            .external-label {
                padding: 10px 16px;
                font-size: 12px;
                min-width: 100px;
                border-width: 2px;
            }
        }
        
        @media (max-width: 480px) {
            .donut-wrapper {
                width: 280px;
                height: 280px;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 10px;
                overflow: visible;
            }
            
            .donut-center {
                top: 40%;
            }
            
            .external-label {
                padding: 8px 12px;
                font-size: 11px;
                min-width: 90px;
                border-width: 1px;
            }
        }
        
        /* Media queries para altura pequena - versão mais conservadora */
        @media (max-height: 600px) {
            h1 {
                font-size: 2rem !important;
                margin-bottom: 0.5rem;
            }
            
            header {
                padding: 0.75rem 0.5rem !important;
            }
        }
        
        @media (max-height: 500px) {
            h1 {
                font-size: 1.75rem !important;
                margin-bottom: 0.25rem;
            }
            
            header {
                padding: 0.5rem 0.5rem !important;
            }
            
            header p {
                font-size: 0.875rem !important;
                margin-bottom: 0.5rem !important;
            }
        }
        
        /* Otimizar para telas ultrawide - header mais compacto */
        @media (min-width: 1400px) and (min-height: 800px) {
            header {
                padding: 1rem 2rem !important;
            }
            
            h1 {
                font-size: 3rem !important;
            }
        }

        /* Estilos para o modal */
        .modal-overlay {
            transition: opacity 0.3s ease-in-out;
            background: rgba(0, 0, 0, 0.7) url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="%23ffffff" opacity="0.05"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>') repeat;
            backdrop-filter: blur(10px);
        }
        
        .modal-content {
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border-top-width: 6px;
        }

        /* Modo escuro para modais */
        body.dark .modal-content {
            background: #1e293b;
            color: #e2e8f0;
            border-color: #374151;
        }

        body.dark .modal-content h2 {
            background: linear-gradient(to right, #3b82f6, #8b5cf6, #6366f1);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
        }

        /* Filtros no modo escuro */
        body.dark .filter-container input,
        body.dark .filter-container select {
            background: #374151;
            color: #e2e8f0;
            border-color: #4b5563;
        }

        body.dark .filter-container input::placeholder {
            color: #9ca3af;
        }

        body.dark .filter-container label {
            color: #d1d5db;
        }

        /* Cards no modo escuro */
        body.dark .comparison-card {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            border-color: #4b5563;
            color: #e2e8f0;
        }

        body.dark .comparison-card h3 {
            color: #f3f4f6;
        }

        body.dark .comparison-card .rank-badge {
            background: #4b5563;
            color: #e2e8f0;
        }

        body.dark .comparison-card:hover {
            border-color: #6366f1;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
        }

        .modal-overlay.hidden {
            pointer-events: none;
        }
        
        .modal-overlay.hidden .modal-content {
            transform: translateY(20px) scale(0.98);
            opacity: 0;
        }
        
        .veredicto-box { border-left-width: 4px; }
        .veredicto-ibm { border-color: #3b82f6; background-color: #eff6ff; }
        .veredicto-crowdstrike { border-color: #14b8a6; background-color: #f0fdfa; }

        /* Vereditos no modo escuro */
        body.dark .veredicto-ibm {
            background-color: #1e3a8a;
            color: #e2e8f0;
            border-color: #60a5fa;
        }

        body.dark .veredicto-crowdstrike {
            background-color: #134e4a;
            color: #e2e8f0;
            border-color: #5eead4;
        }

        /* Legenda no modo escuro */
        body.dark .legend-item {
            color: #e2e8f0;
        }

        body.dark .legend-item .check-icon {
            background: #374151;
        }

        /* Bullets/itens de lista no modo escuro */
        body.dark li span.text-red-600 {
            color: #f87171 !important; /* red-400 para melhor contraste */
        }

        body.dark li span.text-green-600 {
            color: #4ade80 !important; /* green-400 para melhor contraste */
        }

        body.dark li span.text-slate-500 {
            color: #94a3b8 !important; /* slate-400 para melhor contraste */
        }

        /* Texto dos bullets no modo escuro */
        body.dark [data-searchable] li {
            color: #e2e8f0;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }

        /* Botão de tela cheia elegante com efeito de respiração */
        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(79, 70, 229, 0.3);
            border-radius: 12px;
            cursor: pointer;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease, opacity 0.5s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            animation: breathingEffect 4s ease-in-out infinite;
        }

        .fullscreen-btn:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(79, 70, 229, 0.6);
            box-shadow: 0 8px 25px rgba(79, 70, 229, 0.15), 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .fullscreen-btn:active {
            transform: scale(0.9);
            transition: all 0.1s ease;
        }

        .fullscreen-btn i {
            font-size: 18px;
            color: #4f46e5;
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover i {
            color: #3730a3;
            transform: scale(1.05);
        }

        /* Animação de respiração realística */
        @keyframes breathingEffect {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
                border-color: rgba(79, 70, 229, 0.3);
            }
            50% {
                transform: scale(1.04);
                box-shadow: 0 6px 25px rgba(79, 70, 229, 0.2), 0 4px 15px rgba(0, 0, 0, 0.15);
                border-color: rgba(79, 70, 229, 0.4);
            }
        }
        /* Modo escuro para o botão com efeito de respiração */
        body.dark .fullscreen-btn {
            background: rgba(30, 41, 59, 0.9);
            border-color: rgba(99, 102, 241, 0.4);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            animation: breathingEffectDark 4s ease-in-out infinite;
        }

        /* Animação de respiração para modo escuro */
        @keyframes breathingEffectDark {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                border-color: rgba(99, 102, 241, 0.4);
            }
            50% {
                transform: scale(1.04);
                box-shadow: 0 6px 25px rgba(99, 102, 241, 0.3), 0 4px 15px rgba(0, 0, 0, 0.4);
                border-color: rgba(99, 102, 241, 0.6);
            }
        }

        /* Tooltip elegante */
        .fullscreen-btn .tooltip {
            position: absolute;
            bottom: -45px;
            right: 0;
            background: rgba(30, 41, 59, 0.95);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none;
            backdrop-filter: blur(10px);
        }

        .fullscreen-btn:hover .tooltip {
            opacity: 1;
            transform: translateY(0);
        }

        .fullscreen-btn .tooltip::before {
            content: '';
            position: absolute;
            top: -4px;
            right: 10px;
            width: 8px;
            height: 8px;
            background: rgba(30, 41, 59, 0.95);
            transform: rotate(45deg);
        }

        /* Modo escuro para o botão com animações melhoradas */
        body.dark .fullscreen-btn {
            background: rgba(30, 41, 59, 0.9);
            border-color: rgba(99, 102, 241, 0.4);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        body.dark .fullscreen-btn:hover {
            background: rgba(30, 41, 59, 0.95);
            border-color: rgba(99, 102, 241, 0.7);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.2), 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        body.dark .fullscreen-btn i {
            color: #818cf8;
        }

        body.dark .fullscreen-btn:hover i {
            color: #a5b4fc;
        }

        /* Estilos específicos para tela cheia */
        :fullscreen .modal-content {
            max-width: 95vw;
            max-height: 95vh;
            padding: 2rem;
        }

        :fullscreen #discover-grid,
        :fullscreen #assess-grid,
        :fullscreen #control-grid,
        :fullscreen #report-grid {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            max-width: none;
        }

        /* Para telas muito grandes em fullscreen, limitar a 4 colunas */
        @media (min-width: 1400px) {
            :fullscreen #discover-grid,
            :fullscreen #assess-grid,
            :fullscreen #control-grid,
            :fullscreen #report-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 2rem;
            }
        }

        /* Melhor espaçamento dos cards em fullscreen */
        :fullscreen .modal-content .border {
            padding: 1.5rem;
            font-size: 0.95rem;
        }

        :fullscreen .modal-content .border h3 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }
        
        /* Otimizar modais para telas grandes */
        @media (min-width: 1400px) {
            .modal-content {
                max-width: 1200px !important;
                width: 90vw !important;
            }
        }
        
        @media (min-width: 1920px) {
            .modal-content {
                max-width: 1400px !important;
                width: 80vw !important;
            }
        }
    </style>
</head>
<body class="dark">
    <!-- Botão de tela cheia elegante -->
    <button class="fullscreen-btn" onclick="toggleFullscreen()">
        <i class="fas fa-expand"></i>
        <div class="tooltip">Tela Cheia</div>
    </button>

    <!-- Container principal com design limpo -->
    <div class="main-container relative z-10 min-h-screen p-2 flex flex-col">
        <!-- Header elegante -->
        <header class="text-center py-2 px-2 relative flex-shrink-0">
            <div class="animate-fade-in">
                <h1 class="text-3xl md:text-5xl font-bold mb-2">
                    <i class="fas fa-shield-alt mr-3 gradient-shield-icon"></i>
                    <span class="gradient-title-text">Framework de Segurança IA</span>
                </h1>
                <p class="text-lg md:text-xl text-gray-700 dark:text-gray-300 mb-1 font-light">
                    Painel de Análise Comparativa
                </p>
                <p class="text-base text-gray-600 dark:text-gray-400 max-w-2xl mx-auto leading-relaxed mb-4">
                    Visualização interativa de soluções de segurança.
                </p>
            </div>
        </header>

        <!-- Seção principal com donut interativo -->
        <main class="relative px-2 pb-2 pt-1 flex-1 flex items-center justify-center min-h-0">
            <section id="donut-navigation" class="flex flex-col items-center animate-fade-in w-full" style="animation-delay: 300ms;">
                <!-- Roda do Donut modernizada -->
                <div class="donut-wrapper relative">
                    <!-- Peça 1: Descoberta (Superior Esquerda) -->
                    <div class="donut-piece top-left discovery" data-section="discover" onclick="showModal('discover-modal')" tabindex="0">
                        <img src="row-1-column-1.png" alt="Framework de Descoberta" loading="lazy" decoding="async" />
                    </div>
                    
                    <!-- Peça 2: Avaliação (Superior Direita) -->
                    <div class="donut-piece top-right assessment" data-section="assess" onclick="showModal('assess-modal')" tabindex="0">
                        <img src="row-1-column-2.png" alt="Framework de Avaliação" loading="lazy" decoding="async" />
                    </div>
                    
                    <!-- Peça 3: Controle (Inferior Esquerda) -->
                    <div class="donut-piece bottom-left control" data-section="control" onclick="showModal('control-modal')" tabindex="0">
                        <img src="row-2-column-1.png" alt="Framework de Controle" loading="lazy" decoding="async" />
                    </div>
                    
                    <!-- Peça 4: Governança (Inferior Direita) -->
                    <div class="donut-piece bottom-right governance" data-section="report" onclick="showModal('report-modal')" tabindex="0">
                        <img src="row-2-column-2.png" alt="Framework de Governança" loading="lazy" decoding="async" />
                    </div>
                    
                    <!-- Labels externos modernos com ícones -->
                    <div class="external-label label-discovery discovery-label" data-section="discover" onclick="showModal('discover-modal')" tabindex="0">
                        <i class="fas fa-search mr-2"></i>
                        <span class="gradient-title-text">Discovery</span>
                    </div>
                    
                    <div class="external-label label-assessment assessment-label" data-section="assess" onclick="showModal('assess-modal')" tabindex="0">
                        <i class="fas fa-chart-line mr-2"></i>
                        <span class="gradient-title-text">Assessment</span>
                    </div>
                    
                    <div class="external-label label-control control-label" data-section="control" onclick="showModal('control-modal')" tabindex="0">
                        <i class="fas fa-cogs mr-2"></i>
                        <span class="gradient-title-text">Control</span>
                    </div>
                    
                    <div class="external-label label-governance governance-label" data-section="report" onclick="showModal('report-modal')" tabindex="0">
                        <i class="fas fa-clipboard-check mr-2"></i>
                        <span class="gradient-title-text">Governance</span>
                    </div>
                    
                    <!-- Centro do donut modernizado -->
                    <div class="donut-center">
                        <i class="fas fa-brain text-2xl text-blue-600 mb-2"></i>
                        <div class="text-white text-sm font-semibold text-center">
                            <div>AI</div>
                            <div>Security</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Modals Container -->
        <div id="modal-container"></div>
    </div>

<script>
    // Função para alternar tela cheia
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            // Entrar em tela cheia
            document.documentElement.requestFullscreen().then(() => {
                updateFullscreenButton(true);
                showFullscreenNotification('Modo tela cheia ativado.');
            }).catch((err) => {
                console.log('Erro ao entrar em tela cheia:', err);
                showFullscreenNotification('Não foi possível ativar o modo tela cheia.');
            });
        } else {
            // Sair da tela cheia
            document.exitFullscreen().then(() => {
                updateFullscreenButton(false);
                showFullscreenNotification('Modo tela cheia desativado.');
            }).catch((err) => {
                console.log('Erro ao sair da tela cheia:', err);
            });
        }
    }

    // Atualizar ícone do botão baseado no estado
    function updateFullscreenButton(isFullscreen) {
        const btn = document.querySelector('.fullscreen-btn');
        const icon = btn.querySelector('i');
        const tooltip = btn.querySelector('.tooltip');
        
        if (isFullscreen) {
            // Ocultar botão completamente em tela cheia
            btn.style.opacity = '0';
            btn.style.pointerEvents = 'none';
            btn.style.animation = 'none';
            icon.className = 'fas fa-compress';
            tooltip.textContent = 'Sair';
            btn.title = 'Clique para sair da tela cheia';
        } else {
            // Mostrar botão no modo normal
            btn.style.opacity = '1';
            btn.style.pointerEvents = 'auto';
            icon.className = 'fas fa-expand';
            tooltip.textContent = 'Clique';
            btn.title = '';
            // Retomar animação de respiração no modo normal
            const isDark = document.body.classList.contains('dark');
            btn.style.animation = isDark ? 'breathingEffectDark 4s ease-in-out infinite' : 'breathingEffect 4s ease-in-out infinite';
        }
    }

    // Mostrar notificação elegante
    function showFullscreenNotification(message) {
        // Remove notificação existente se houver
        const existingNotification = document.querySelector('.fullscreen-notification');
        if (existingNotification) {
            existingNotification.remove();
        }

        // Criar nova notificação
        const notification = document.createElement('div');
        notification.className = 'fullscreen-notification';
        notification.innerHTML = `
            <div class="notification-content">
                <i class="fas fa-info-circle"></i>
                <span>${message}</span>
            </div>
        `;
        
        // Adicionar estilos inline para a notificação
        notification.style.cssText = `
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(79, 70, 229, 0.95);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            z-index: 60;
            transform: translateX(100%);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 300px;
        `;

        notification.querySelector('.notification-content').style.cssText = `
            display: flex;
            align-items: center;
            gap: 10px;
        `;

        document.body.appendChild(notification);

        // Animar entrada
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);

        // Remover após 3 segundos
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 400);
        }, 3000);
    }

    // Detectar mudanças de tela cheia (F11, ESC, etc.)
    document.addEventListener('fullscreenchange', () => {
        updateFullscreenButton(!!document.fullscreenElement);
    });

    // Detectar tecla F11
    document.addEventListener('keydown', (e) => {
        if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });

    // Efeitos simples do botão
    function addButtonSimpleEffects() {
        const btn = document.querySelector('.fullscreen-btn');
        
        // Apenas um efeito de hover suave
        btn.addEventListener('mouseenter', () => {
            btn.style.transform = 'scale(1.05)';
        });

        btn.addEventListener('mouseleave', () => {
            btn.style.transform = 'scale(1)';
        });
    }

    // Inicializar efeitos simples quando a página carrega
    document.addEventListener('DOMContentLoaded', () => {
        addButtonSimpleEffects();
    });

    const contentData = {
        discover: {
            title: '1. Descoberta: Visibilidade Total',
            intro: 'O objetivo aqui é eliminar a "Shadow AI" e criar um inventário completo de todos os modelos e casos de uso para entender a superfície de ataque.',
            solutions: [
                { title: 'IBM Guardium', points: ['Varredura sem agente (agentless) de contas na nuvem e repositórios de código.', 'Foco em modelos e agentes de IA não sancionados em ambientes de nuvem e desenvolvimento.'] },
                { title: 'Lakera', points: ['Não aplicável. A plataforma protege aplicações conhecidas, mas não descobre ativamente as desconhecidas.', 'A descoberta de ameaças ocorre dentro das aplicações já protegidas.'] },
                { title: 'Coralogix', points: ['Análise de dados de observabilidade (logs, traces) e varredura de repositórios de código.', 'Identifica "Shadow AI" impulsionada pela atividade de desenvolvedores.'] },
                { title: 'Crowdstrike', points: ['Visibilidade da plataforma unificada (agente de endpoint, conectores SaaS, sensores de nuvem).', 'Detecta o uso de ferramentas públicas de GenAI por funcionários e pacotes de IA em builds.'] },
                { title: 'Securiti', points: ['Varredura automatizada de nuvens (IaaS/PaaS) e SaaS para catalogar modelos de IA.', 'Cria inventário de "shadow AI" e mapeia os dados que esses modelos acessam.'] },
                { title: 'TrojAI', points: ['[NEG] Focado em detecção de trojans em modelos, não descoberta de Shadow AI em organizações.', '[NEG] Não possui capacidades de varredura de nuvens ou SaaS para identificar uso não autorizado de IA.'] },
                { title: 'CrewAI', points: ['[NEUTRO] Framework de orquestração de agentes, mas não focado especificamente em discovery de Shadow AI.', 'Pode ser usado para descoberta colaborativa, mas requer configuração específica para segurança.'] },
            ],
            verdict: {
                winner: 'Crowdstrike',
                reason: 'A abordagem multifacetada, que aproveita a ampla visibilidade desde o endpoint do usuário até o pipeline na nuvem, oferece a descoberta mais abrangente de usos de IA sancionados e não sancionados.',
                runner_up: 'Securiti',
                runner_up_reason: 'Sua capacidade de vincular o inventário de modelos de IA diretamente ao cenário de dados subjacente responde não apenas "quais modelos temos?", mas também "quais dados sensíveis eles podem acessar?".'
            }
        },
        assess: {
            title: '2. Avaliação: Quantificar Riscos',
            intro: 'Esta etapa avalia a postura de segurança, envolvendo varredura de vulnerabilidades e testes adversários para simular ataques do mundo real.',
            solutions: [
                { title: 'IBM Guardium', points: ['AI-SPM para varredura de vulnerabilidades e configurações incorretas.', 'Executa testes de penetração (pen testing) automatizados como um recurso da plataforma.'] },
                { title: 'Lakera', points: ['Benchmarking contínuo de modelos contra um banco de dados de ameaças em tempo real.', 'Uso de ferramentas de Red Teaming (Lakera Red) e inteligência de crowdsourcing (Gandalf).'] },
                { title: 'Coralogix', points: ['AI-SPM em tempo real com pontuação de postura dinâmica baseada em telemetria em tempo real.', 'Detecção de ameaças via "Avaliadores de Segurança" personalizáveis em dados em tempo real.'] },
                { title: 'Crowdstrike', points: ['AI-SPM para ativos na nuvem com priorização de vulnerabilidades via EXPRT.AI.', 'Oferece serviços de AI Red Team liderados por especialistas para simulações de ataque aprofundadas.'] },
                { title: 'Securiti', points: ['Avaliação de risco de modelo para viés, toxicidade e violação de direitos autorais.', 'Mapeamento do fluxo de dados (Data+AI Mapping) para identificar riscos na linhagem dos dados.'] },
                { title: 'TrojAI', points: ['Testes especializados para detecção de trojans e backdoors em modelos de IA treinados.', 'Avaliação adversária específica para identificar vulnerabilidades de segurança em arquiteturas de ML.'] },
                { title: 'CrewAI', points: ['[NEUTRO] Pode ser configurado para testes colaborativos, mas não é uma ferramenta nativa de assessment de segurança.', '[NEUTRO] Framework genérico que requer expertise em segurança para implementar avaliações adequadas.'] },
            ],
            verdict: {
                winner: 'Lakera',
                reason: 'A abordagem dinâmica e baseada em crowdsourcing, utilizando o jogo "Gandalf" para alimentar seu banco de dados de ameaças em tempo real, é um método único e poderoso para se manter à frente de exploits emergentes.',
                runner_up: 'IBM Guardium',
                runner_up_reason: 'A ênfase em testes de penetração automatizados integrados diretamente na plataforma oferece uma capacidade de avaliação adversária proativa e escalável.'
            }
        },
        control: {
            title: '3. Controle: Proteção Proativa',
            intro: 'A camada de defesa ativa, onde políticas são aplicadas para proteger os sistemas de IA, prevenindo fuga de dados e bloqueando ataques de injeção de prompt.',
            solutions: [
                { title: 'IBM Guardium', points: ['Gateway de IA nativo para detectar e bloquear injeção de prompt e "jailbreaks".', 'Bloqueio de dados sensíveis (PII/PHI) em prompts e respostas com base em políticas.'] },
                { title: 'Lakera', points: ['Gateway de API de baixa latência (Lakera Guard) como principal recurso para proteção em tempo real.', 'Previne ataques de prompt e vazamento de dados (PII) nas interações com o LLM.'] },
                { title: 'Coralogix', points: ['Detecção em tempo real de injeção de prompt e exposição de dados via análise em fluxo.', 'O foco principal é na detecção e alerta, com capacidades de bloqueio menos centrais.'] },
                { title: 'Crowdstrike', points: ['Foco principal na prevenção de perda de dados (DLP) no endpoint.', 'Bloqueia uploads de dados sensíveis para ferramentas de GenAI, mas não analisa os prompts de entrada.'] },
                { title: 'Securiti', points: ['Firewall de LLM de 3 estágios (Prompt, Retrieval, Response) para proteção completa.', 'O "Retrieval Firewall" aplica controles de acesso aos dados que alimentam sistemas RAG.'] },
                { title: 'TrojAI', points: ['[NEG] Focado em detecção de trojans, mas não oferece controles proativos ou bloqueio em tempo real.', '[NEG] Não possui funcionalidades de gateway ou firewall para proteção de aplicações em produção.'] },
                { title: 'CrewAI', points: ['Controle nativo de orquestração para sistemas multi-agentes autônomos com políticas de segurança distribuídas.', 'Única solução que oferece gerenciamento granular de permissões e workflows entre agentes de IA colaborativos.'] },
            ],
            verdict: {
                winner: 'CrewAI',
                reason: 'Oferece controle nativo de orquestração de agentes autônomos com políticas de segurança distribuídas, representando a próxima geração de controle em sistemas de IA multi-agentes complexos.',
                runner_up: 'Securiti',
                runner_up_reason: 'A arquitetura de firewall de 3 estágios, especialmente o "Retrieval Firewall", aborda o principal vetor de risco em arquiteturas RAG empresariais tradicionais.'
            }
        },
        report: {
            title: '4. Governança e Relatórios',
            intro: 'A camada final traduz dados técnicos em insights de negócio, garantindo a conformidade com regulamentações e políticas internas através de painéis e relatórios.',
            solutions: [
                { title: 'IBM Guardium', points: ['Dashboards unificados que combinam métricas de segurança (Guardium) e governança (watsonx).', 'Mapeamento explícito para frameworks como EU AI Act, NIST e ISO 42001.'] },
                { title: 'Lakera', points: ['[NEUTRO] Dashboards de gerenciamento de risco focados em ameaças a nível de aplicação.', '[NEUTRO] Forte alinhamento com o framework OWASP Top 10 para LLMs.'] },
                { title: 'Coralogix', points: ['Dashboard do AI-SPM com pontuações de postura, usuários de alto risco e tendências.', 'Mapeamento para padrões como ISO 42001, com forte capacidade de retenção de dados para auditoria.'] },
                { title: 'Crowdstrike', points: ['Console unificado da Falcon com análise acelerada por IA (Charlotte AI).', 'Relatórios de avaliação mapeados para frameworks como o NIST.'] },
                { title: 'Securiti', points: ['Dashboard de inteligência centralizado com alertas de segurança e violações de políticas.', 'Mapeamento para mais de 20 regulamentações globais, com automação de verificações de conformidade.'] },
                { title: 'TrojAI', points: ['[NEG] Focado em detecção técnica de trojans, sem capacidades de dashboard ou relatórios de conformidade.', '[NEG] Não possui mapeamento para frameworks regulatórios ou governança empresarial.'] },
                { title: 'CrewAI', points: ['[NEUTRO] Framework de orquestração de agentes, mas não específico para governança de segurança empresarial.', '[NEUTRO] Pode gerar relatórios colaborativos, mas não possui mapeamento nativo para frameworks regulatórios.'] },
            ],
            verdict: {
                winner: 'Securiti',
                reason: 'A amplitude de regulamentações suportadas (+20), juntamente com a automação de verificações de conformidade e a geração de relatórios prontos para auditoria, oferece a mais poderosa capacidade de GRC centrada em dados.',
                runner_up: 'IBM Guardium',
                runner_up_reason: 'A integração nativa com uma plataforma GRC dedicada (watsonx.governance) cria uma fonte única de verdade para equipes de segurança e risco, uma proposta poderosa para grandes empresas.'
            }
        }
    };

    function createModalHTML(sectionKey) {
        const data = contentData[sectionKey];
        const modalBorderColors = {
            discover: 'border-blue-500',
            assess: 'border-teal-500',
            control: 'border-indigo-500',
            report: 'border-amber-500',
        };
    const checkIcon = `<svg class="w-5 h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg>`;
    const neutralIcon = `<svg class="w-5 h-5 mr-2 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 110 20 10 10 0 010-20zm-6 10a1 1 0 001 1h10a1 1 0 100-2H7a1 1 0 00-1 1z"/></svg>`;
    const xIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-3.5-6.5l7-7m0 7l-7-7"/></svg>`;
    const trophyIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" viewBox="0 0 24 24" fill="currentColor"><path d="M16 2a1 1 0 0 1 1 1v2h3a1 1 0 0 1 1 1 6 6 0 0 1-6 6h-1v3h1a3 3 0 0 1 3 3v3H6v-3a3 3 0 0 1 3-3h1v-3H9A6 6 0 0 1 3 6a1 1 0 0 1 1-1h3V3a1 1 0 0 1 1-1h8zM6 7H5.08A4.01 4.01 0 0 0 9 10V7H6zm12 0h-3v3a4.01 4.01 0 0 0 3.92-3H18z"/></svg>`;
    const starIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.5l2.9 6.1 6.7.9-4.9 4.6 1.2 6.6L12 17.9l-5.9 2.8 1.2-6.6-4.9-4.6 6.7-.9L12 2.5z"/></svg>`;

        const veredictHTML = `
            <div class="mt-8 p-4 rounded-lg bg-amber-50 dark:bg-amber-900/30 border-l-4 border-green-500 dark:border-green-400">
                <h4 class="font-bold text-lg mb-2 flex items-center text-zinc-600 dark:text-zinc-300">
                    <span class="text-amber-700 dark:text-amber-400">${trophyIcon}</span>
                    Veredito (Vencedor): ${data.verdict.winner}
                </h4>
                <p class="text-slate-700 dark:text-slate-300 pl-8 mb-4">${data.verdict.reason}</p>
                
                <h4 class="font-bold text-lg mb-2 flex items-center text-zinc-600 dark:text-zinc-300">
                    <span class="text-amber-700 dark:text-amber-400">${starIcon}</span>
                    2º Lugar: ${data.verdict.runner_up}
                </h4>
                <p class="text-slate-600 dark:text-slate-400 pl-8">${data.verdict.runner_up_reason}</p>
            </div>
        `;

        const solutionsHTML = [...data.solutions].sort((a, b) => {
            // Função para calcular score de qualidade da ferramenta
            const getQualityScore = (solution) => {
                let positiveCount = 0;
                let neutralCount = 0;
                let negativeCount = 0;
                
                solution.points.forEach(p => {
                    const hasNegTag = /\[(NEG|NA)\]/i.test(p);
                    const hasPartTag = /\[(PART|NEUTRO)\]/i.test(p);
                    const cleanText = p.replace(/\s*\[(NEG|NA|PART|NEUTRO)\]\s*/ig, '').trim();
                    
                    // Padrões mais específicos para negativos
                    const negativePatterns = /(não aplicável|não possui|não oferece|focado em.*mas não|sem capacidades|focado em.*sem)/i;
                    const isNeg = hasNegTag || negativePatterns.test(cleanText);
                    
                    // Padrões para parciais/neutros (incluindo frases específicas do Lakera)
                    const partialPatterns = /(parcial(?:mente)?|limitad[oa]s?|foco principal|apenas|somente|menos centrais?|focados em ameaças a nível de aplicação|alinhamento com.*framework)/i;
                    const isPart = !isNeg && (hasPartTag || partialPatterns.test(cleanText));
                    
                    if (isNeg) negativeCount++;
                    else if (isPart) neutralCount++;
                    else positiveCount++;
                });
                
                // Score: positivos valem mais, negativos penalizam mais
                return (positiveCount * 4) + (neutralCount * 1) - (negativeCount * 3);
            };
            
            // Ordenação: vencedor primeiro, depois por score, runner-up pode ser reposicionado
            const w = data.verdict.winner;
            const r = data.verdict.runner_up;
            
            const aIsWinner = a.title === w;
            const bIsWinner = b.title === w;
            
            // Vencedor sempre primeiro
            if (aIsWinner && !bIsWinner) return -1;
            if (bIsWinner && !aIsWinner) return 1;
            
            // Para todos os outros (incluindo runner-up), ordenar por score de qualidade
            const aScore = getQualityScore(a);
            const bScore = getQualityScore(b);
            
            // Se têm scores diferentes, ordenar pelo score
            if (aScore !== bScore) {
                return bScore - aScore; // Score maior primeiro (esquerda)
            }
            
            // Se scores iguais, runner-up tem prioridade
            const aIsRunnerUp = a.title === r;
            const bIsRunnerUp = b.title === r;
            if (aIsRunnerUp && !bIsRunnerUp) return -1;
            if (bIsRunnerUp && !aIsRunnerUp) return 1;
            
            // Caso contrário, manter ordem alfabética
            return a.title.localeCompare(b.title);
        }).map(solution => {
            const isWinner = solution.title === data.verdict.winner;
            const isRunnerUp = solution.title === data.verdict.runner_up;
            const cardRing = isWinner ? 'ring-2 ring-green-500' : (isRunnerUp ? 'ring-2 ring-zinc-400' : '');
            const cardTint = isWinner ? 'bg-gradient-to-br from-amber-50 to-yellow-50 border-green-500 dark:from-amber-900/20 dark:to-yellow-900/20 dark:border-green-400' : (isRunnerUp ? 'bg-gradient-to-br from-slate-50 to-gray-50 border-zinc-200 dark:from-slate-800 dark:to-gray-800 dark:border-zinc-600' : 'bg-gradient-to-br from-white to-slate-50 border-slate-200 dark:from-slate-700 dark:to-slate-800 dark:border-slate-600');
            // Frases exatas configuráveis
            const EXACT_NEGATIVES = [
                'Não aplicável. A plataforma protege aplicações conhecidas, mas não descobre ativamente as desconhecidas.',
                'A descoberta de ameaças ocorre dentro das aplicações já protegidas.'
            ];
            const EXACT_NEUTRALS = [
                'Dashboards de gerenciamento de risco focados em ameaças a nível de aplicação.',
                'Forte alinhamento com o framework OWASP Top 10 para LLMs.',
                'Bloqueia uploads de dados sensíveis para ferramentas de GenAI, mas não analisa os prompts de entrada.'
            ];
            const escapeRegex = (s) => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const negativePatterns = new RegExp('^\\s*(?:' + EXACT_NEGATIVES.map(escapeRegex).join('|') + ')\\s*$', 'i');
            const exactNeutralRegex = new RegExp('^\\s*(?:' + EXACT_NEUTRALS.map(escapeRegex).join('|') + ')\\s*$', 'i');
            // Heurísticas para cobertura parcial/limitada -> tick neutro (cinza)
            const partialPatterns = /(parcial(?:mente)?|limitad[oa]s?|restrit[oa]s?|b[áa]sic[oa]s?|incipient[ea]|menos\s+centrais?|(?:n(?:ã|a)o\s+)?[ée]\s+foco|foco\s+principal(?:\s+(?:em|no|na))?|foco\s+maior\s+(?:em|no|na)|prioritariamente|principalmente|apenas|somente|melhor\s+em|mais\s+voltad[oa]\s+a|detec(?:ç|c)[ãa]o\s+(?:e\s+)?alerta|somente\s+(?:detec(?:ç|c)[ãa]o|alerta)|sem\s+(?:bloqueio|enforcement)|bloqueio\s+menos\s+centrais?|n(?:ã|a)o\s+nativo|via\s+parceir[oa]s?|em\s+parceria|depende\s+de\s+parceir[oa]s?|requer\s+servi(?:ç|c)os\s+profissionais|integra(?:ç|c)(?:[ãa]o|[õo]es)\s+limitad[as]?|suporte\s+parcial|cobertura\s+parcial|automa(?:ç|c)[ãa]o\s+limitada|(?:em\s+)?(?:beta|preview|roadmap))/i;
            const badge = isWinner ? `<span class=\"ml-2 inline-flex items-center text-amber-700\">${trophyIcon}</span>` : (isRunnerUp ? '' : '');
            const rankOf = (t) => (t === data.verdict.winner ? 0 : t === data.verdict.runner_up ? 1 : 2);
            return `
            <div class="border ${cardTint} p-6 xl:p-5 rounded-xl flex flex-col ${cardRing} transition-all duration-300 hover:shadow-lg hover:scale-105 hover:-translate-y-1" data-rank="${rankOf(solution.title)}" style="transition: ${window.matchMedia('(prefers-reduced-motion: reduce)').matches ? 'none' : 'all 0.3s ease'}">
                <h3 class="font-bold text-lg xl:text-xl mb-4 text-slate-700 dark:text-slate-200 flex items-center">${solution.title}${badge}</h3>
                <ul class="space-y-3 text-slate-700 dark:text-slate-300 flex-grow text-base xl:text-sm leading-relaxed" data-searchable>
                    ${solution.points.map(p => {
                        const hasNegTag = /\[(NEG|NA)\]/i.test(p);
                        const hasPartTag = /\[(PART|NEUTRO)\]/i.test(p);
                        const cleanText = p.replace(/\s*\[(NEG|NA|PART|NEUTRO)\]\s*/ig, '').trim();
                        const isNeg = hasNegTag || negativePatterns.test(cleanText);
                        const isExactPartial = exactNeutralRegex.test(cleanText);
                        const isPart = !isNeg && (hasPartTag || isExactPartial || partialPatterns.test(cleanText));
                        const icon = isNeg ? xIcon : (isPart ? neutralIcon : checkIcon);
                        const color = isNeg ? 'text-red-600' : (isPart ? 'text-slate-500' : 'text-green-600');
                        const emphasis = isPart ? 'opacity-80' : '';
                        return `<li class=\"flex items-start animate-fade-in\" data-type=\"${isNeg ? 'negative' : (isPart ? 'neutral' : 'positive')}\" style=\"animation-delay: ${Math.random() * 0.5}s\"><span class=\"${color} ${emphasis} mt-1 mr-2\">${icon}</span><span>${cleanText}</span></li>`;
                    }).join('')}
                </ul>
            </div>`;
        }).join('');
        
        const legendHTML = `
            <div class="mt-6 text-sm text-slate-600 dark:text-slate-400 flex flex-wrap items-center gap-x-6 gap-y-2 p-3 bg-slate-100 dark:bg-slate-800 rounded-lg" aria-label="Legenda de ícones">
                <div class="flex items-center"><span class="text-green-600 mr-2">${checkIcon}</span><span>Atende totalmente</span></div>
                <div class="flex items-center"><span class="text-slate-500 opacity-80 mr-2">${neutralIcon}</span><span>Parcial / Limitado</span></div>
                <div class="flex items-center"><span class="text-red-600 mr-2">${xIcon}</span><span>Não aplicável / Negativo</span></div>
            </div>
        `;

        return `
            <div id="${sectionKey}-modal" class="modal-overlay hidden fixed inset-0 bg-slate-900 bg-opacity-70 flex items-center justify-center p-4 z-50">
                <div class="modal-content ${modalBorderColors[sectionKey]} bg-white p-6 md:p-10 rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-y-auto" role="dialog" aria-modal="true" aria-labelledby="${sectionKey}-title" tabindex="-1">
                    <div class="flex justify-between items-center mb-4">
                        <h2 id="${sectionKey}-title" class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent">${data.title}</h2>
                        <button class="close-modal-btn text-slate-500 hover:text-slate-800 dark:text-slate-400 dark:hover:text-slate-200 transition-colors" data-modal="${sectionKey}-modal" aria-label="Fechar modal: ${data.title}">
                            <span class="text-3xl font-light" aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <p class="text-slate-600 dark:text-slate-300 mb-4 leading-relaxed">${data.intro}</p>
                    
                    <!-- Controles de filtro e busca -->
                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-6 p-4 bg-slate-50 dark:bg-slate-800 rounded-lg">
                        <div class="flex-1 w-full">
                            <input type="text" 
                                   id="${sectionKey}-search" 
                                   placeholder="Buscar funcionalidades, tecnologias..." 
                                   class="w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div class="flex items-center gap-4">
                            <label class="inline-flex items-center text-sm text-slate-600 dark:text-slate-300">
                                <input type="checkbox" class="top2-toggle mr-2" data-section="${sectionKey}">
                                <span>Só vencedor e 2º</span>
                            </label>
                            <select id="${sectionKey}-filter" class="px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm">
                                <option value="all">Todos</option>
                                <option value="positive">✓ Positivos</option>
                                <option value="neutral">~ Neutros</option>
                                <option value="negative">✗ Negativos</option>
                            </select>
                        </div>
                    </div>
                    <div id="${sectionKey}-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6 xl:gap-5">
                        ${solutionsHTML}
                    </div>
                    ${legendHTML}
                    ${veredictHTML}
                </div>
            </div>
        `;
    }

    document.addEventListener('DOMContentLoaded', function() {
        const modalContainer = document.getElementById('modal-container');
        let lastFocusedElement = null;

        // Criar modais para todas as seções
        Object.keys(contentData).forEach(key => {
            modalContainer.insertAdjacentHTML('beforeend', createModalHTML(key));
        });

        // Função global para mostrar modal
        window.showModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                // Acessibilidade: foco inicial e trap
                lastFocusedElement = document.activeElement;
                const content = modal.querySelector('.modal-content');
                if (content) {
                    content.focus();
                }
                // Atualizar hash para deep link
                const key = modalId.replace('-modal','');
                const map = { discover: '#discover', assess: '#assess', control: '#control', report: '#report' };
                const newHash = map[key] || '';
                if (newHash) {
                    history.pushState(null, '', newHash);
                }
            } else {
                console.error('Modal not found:', modalId);
            }
        };

        // Função global para esconder modal
        window.hideModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = '';
                // Restaurar foco ao elemento que abriu o modal
                if (lastFocusedElement && typeof lastFocusedElement.focus === 'function') {
                    lastFocusedElement.focus();
                }
                lastFocusedElement = null;
                // Limpar hash ao fechar
                if (location.hash) {
                    history.pushState(null, '', location.pathname + location.search);
                }
            }
        };

        // Event listeners para fechar modais
        document.addEventListener('click', function(event) {
            // Fechar modal clicando no botão X
            if (event.target.classList.contains('close-modal-btn') || event.target.closest('.close-modal-btn')) {
                const button = event.target.closest('.close-modal-btn');
                if (button) {
                    hideModal(button.dataset.modal);
                }
            }
            
            // Fechar modal clicando fora do conteúdo
            if (event.target.classList.contains('modal-overlay')) {
                hideModal(event.target.id);
            }
        });

        // Teclado: ESC para fechar e trap de foco (TAB) dentro do modal aberto
        document.addEventListener('keydown', function(event) {
            const openModal = document.querySelector('.modal-overlay:not(.hidden)');
            if (!openModal) return;

            if (event.key === 'Escape') {
                hideModal(openModal.id);
                return;
            }

            if (event.key === 'Tab') {
                const container = openModal.querySelector('.modal-content');
                if (!container) return;
                const focusableSelectors = [
                    'a[href]','area[href]','button:not([disabled])','input:not([disabled])',
                    'select:not([disabled])','textarea:not([disabled])','summary',
                    '[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'
                ];
                const focusables = Array.from(container.querySelectorAll(focusableSelectors.join(',')))
                    .filter(el => el.offsetParent !== null || el === container);
                if (focusables.length === 0) return;
                const first = focusables[0];
                const last = focusables[focusables.length - 1];
                const active = document.activeElement;
                if (event.shiftKey) {
                    if (active === first || active === container) {
                        event.preventDefault();
                        last.focus();
                    }
                } else {
                    if (active === last) {
                        event.preventDefault();
                        first.focus();
                    }
                }
            }
        });

        // Efeitos elegantes e modernos
        const donutPieces = document.querySelectorAll('.donut-piece');
        const externalLabels = document.querySelectorAll('.external-label');

        // Função para destacar elementos relacionados
        function highlightRelated(index, isActive) {
            const label = externalLabels[index];
            
            if (isActive) {
                // Destacar label com efeito elegante
                if (label) {
                    label.style.transform = label.style.transform.includes('scale') 
                        ? label.style.transform.replace(/scale\([^)]*\)/, 'scale(1.12)')
                        : label.style.transform + ' scale(1.12)';
                    label.style.boxShadow = '0 20px 60px rgba(0,0,0,0.3)';
                    label.style.backdropFilter = 'blur(30px)';
                }
            } else {
                // Resetar efeitos
                if (label) {
                    label.style.transform = label.style.transform.replace(/ scale\([^)]*\)/g, '');
                    label.style.boxShadow = '';
                    label.style.backdropFilter = '';
                }
            }
        }

        // Efeitos para as peças do donut
        donutPieces.forEach((piece, index) => {
            piece.addEventListener('mouseenter', () => highlightRelated(index, true));
            piece.addEventListener('mouseleave', () => highlightRelated(index, false));
            piece.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    const sec = piece.getAttribute('data-section');
                    showModal(sec + '-modal');
                }
            });
        });

        // Efeitos para os labels externos
        externalLabels.forEach((label, index) => {
            const correspondingPiece = donutPieces[index];
            
            label.addEventListener('mouseenter', function() {
                // Destacar peça correspondente
                if (correspondingPiece) {
                    correspondingPiece.style.filter = 'brightness(1.25) drop-shadow(0 12px 40px rgba(0,0,0,0.35))';
                }
                
                // Destacar linha
                highlightRelated(index, true);
            });
            
            label.addEventListener('mouseleave', function() {
                if (correspondingPiece) {
                    correspondingPiece.style.filter = '';
                }
                
                highlightRelated(index, false);
            });

            label.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    const sec = label.getAttribute('data-section');
                    showModal(sec + '-modal');
                }
            });
        });
        
        // Efeito de pulsação elegante no centro
        const donutCenter = document.querySelector('.donut-center');
        if (donutCenter) {
            const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            if (!prefersReduced) {
                let intervalId = setInterval(() => {
                    donutCenter.style.transform = 'translate(-50%, -50%) scale(1.08)';
                    setTimeout(() => {
                        donutCenter.style.transform = 'translate(-50%, -50%) scale(1)';
                    }, 1200);
                }, 8000);
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden && intervalId) {
                        clearInterval(intervalId);
                        intervalId = null;
                    } else if (!document.hidden && !intervalId) {
                        intervalId = setInterval(() => {
                            donutCenter.style.transform = 'translate(-50%, -50%) scale(1.08)';
                            setTimeout(() => {
                                donutCenter.style.transform = 'translate(-50%, -50%) scale(1)';
                            }, 1200);
                        }, 8000);
                    }
                });
            }
        }
        
        // Animação de entrada suave e elegante
        donutPieces.forEach((piece, index) => {
            piece.style.opacity = '0';
            piece.style.transform = 'scale(0.8) rotate(-10deg)';
            
            setTimeout(() => {
                piece.style.transition = 'all 1s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                piece.style.opacity = '1';
                piece.style.transform = 'scale(1) rotate(0deg)';
            }, index * 200);
        });
        
        // Animação dos labels com delay
        externalLabels.forEach((label, index) => {
            label.style.opacity = '0';
            const direction = index % 2 === 0 ? 'translateY(-20px)' : 'translateX(20px)';
            const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            label.style.transform = label.style.transform + ' ' + (prefersReduced ? '' : direction + ' scale(0.8)');
            
            setTimeout(() => {
                label.style.transition = 'all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                label.style.opacity = '1';
                if (!prefersReduced) {
                    label.style.transform = label.style.transform.replace(direction, '').replace('scale(0.8)', 'scale(1)');
                }
            }, 800 + index * 150);
        });
        
        // Adicionar efeito de partículas flutuantes no fundo
        function createFloatingParticles() {
            // Partículas removidas para design mais limpo
        }
        
        // Adicionar CSS para animação de partículas
        const style = document.createElement('style');
        style.textContent = `
            @keyframes float {
                0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
                10% { opacity: 1; }
                90% { opacity: 1; }
                100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // Inicializar sem partículas
        // createFloatingParticles();

        // Deep link: abrir modal baseado no hash
        const openFromHash = () => {
            const h = location.hash.toLowerCase();
            const map = { '#discover': 'discover-modal', '#assess': 'assess-modal', '#control': 'control-modal', '#report': 'report-modal' };
            if (map[h]) {
                showModal(map[h]);
            }
        };
        window.addEventListener('hashchange', openFromHash);
        openFromHash();
        
        // Ajuste apenas para telas extremamente pequenas
        function adjustForVerySmallScreens() {
            const vh = window.innerHeight;
            const vw = window.innerWidth;
            
            // Apenas para casos extremos (celulares antigos ou janelas muito pequenas)
            if (vh < 400 && vw < 350) {
                document.body.classList.add('ultra-compact');
            } else {
                document.body.classList.remove('ultra-compact');
            }
        }
        
        // CSS apenas para casos extremos
        const compactStyle = document.createElement('style');
        compactStyle.textContent = `
            .ultra-compact h1 {
                font-size: 1.25rem !important;
            }
            
            .ultra-compact .donut-wrapper {
                width: 200px !important;
                height: 200px !important;
            }
            
            .ultra-compact .external-label {
                font-size: 9px !important;
                padding: 4px 8px !important;
            }
        `;
        document.head.appendChild(compactStyle);
        
        // Executar apenas na inicialização
        adjustForVerySmallScreens();
        window.addEventListener('resize', adjustForVerySmallScreens);

        // Toggle: mostrar só vencedor e segundo
        document.querySelectorAll('.top2-toggle').forEach(chk => {
            chk.addEventListener('change', (e) => {
                const section = e.target.getAttribute('data-section');
                applyFilters(section);
            });
        });

        // Configurar filtros de busca e tipo
        function setupFilters() {
            Object.keys(contentData).forEach(section => {
                const searchInput = document.getElementById(`${section}-search`);
                const typeFilter = document.getElementById(`${section}-filter`);
                
                if (searchInput) {
                    searchInput.addEventListener('input', () => applyFilters(section));
                }
                if (typeFilter) {
                    typeFilter.addEventListener('change', () => applyFilters(section));
                }
            });
        }

        function applyFilters(section) {
            const grid = document.getElementById(section + '-grid');
            if (!grid) return;
            
            const cards = grid.querySelectorAll('[data-rank]');
            const searchInput = document.getElementById(`${section}-search`);
            const typeFilter = document.getElementById(`${section}-filter`);
            const top2Toggle = document.querySelector(`.top2-toggle[data-section="${section}"]`);
            
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            const typeFilterValue = typeFilter ? typeFilter.value : 'all';
            const showTop2 = top2Toggle ? top2Toggle.checked : false;
            
            cards.forEach(card => {
                const rank = parseInt(card.getAttribute('data-rank'), 10);
                const bullets = card.querySelectorAll('[data-searchable] li');
                
                let showCard = true;
                let visibleBullets = 0;
                
                // Filtro top 2
                if (showTop2 && rank > 1) {
                    showCard = false;
                }
                
                // Processar bullets individualmente
                bullets.forEach(bullet => {
                    const text = bullet.textContent.toLowerCase();
                    const type = bullet.getAttribute('data-type');
                    
                    let showBullet = true;
                    
                    // Filtro de busca
                    if (searchTerm && !text.includes(searchTerm)) {
                        showBullet = false;
                    }
                    
                    // Filtro por tipo
                    if (typeFilterValue !== 'all' && type !== typeFilterValue) {
                        showBullet = false;
                    }
                    
                    bullet.style.display = showBullet ? '' : 'none';
                    if (showBullet) visibleBullets++;
                });
                
                // Esconder card se não tem bullets visíveis (apenas quando há filtros ativos)
                if (visibleBullets === 0 && (searchTerm || typeFilterValue !== 'all')) {
                    showCard = false;
                }
                
                card.style.display = showCard ? '' : 'none';
            });
        }

        // Configurar filtros após um pequeno delay para garantir que os modais foram criados
        setTimeout(setupFilters, 100);
    });
</script>

</body>
</html>

